I need a Kafka Event Flow Diagram showing producers, topics, consumers, and event processing.

IMPORTANT: Single Kafka topic "bookmyhome.events" is used for ALL events. Consumer is DISABLED.

PRODUCERS (left side - blue boxes):

1. BookingsController
   Produces:
   - BookingCreatedEvent
   - BookingConfirmedEvent
   - BookingCancelledEvent
   Note: BookingCompletedEvent does NOT exist (Complete() doesn't raise event)
   
2. UsersController (via User entity)
   Produces:
   - UserCreatedEvent
   - UserDeactivatedEvent
   Note: UserUpdatedEvent does NOT exist

3. Payment Entity
   Note: PaymentCompletedEvent and PaymentRefundedEvent EXIST but are NEVER RAISED
   Reason: Payment is Entity (not AggregateRoot), cannot raise events

KAFKA TOPIC (center - orange cylinder):

1. bookmyhome.events (SINGLE TOPIC for all events)
   Partitions: 1 (default)
   Replication: 1
   Retention: 7 days (default)
   Events (all in same topic):
   - BookingCreatedEvent
   - BookingConfirmedEvent
   - BookingCancelledEvent
   - UserCreatedEvent
   - UserDeactivatedEvent
   - PaymentCompletedEvent (exists but never raised)
   - PaymentRefundedEvent (exists but never raised)
   
   Event Type Identification:
   - Event type stored in message key or event body
   - Consumers filter by event type

CONSUMERS (right side - green boxes with RED X):

1. KafkaConsumer (BackgroundService) - DISABLED
   Status: ❌ NOT REGISTERED (commented out in Program.cs:227)
   Would subscribe to: bookmyhome.events
   Group ID: bookmyhome-consumer-group
   Would handle:
   - BookingCreatedEvent → NotificationEventHandler
   - BookingConfirmedEvent → NotificationEventHandler
   - BookingCancelledEvent → NotificationEventHandler
   - UserCreatedEvent → NotificationEventHandler
   - UserDeactivatedEvent → NotificationEventHandler
   
2. NotificationEventHandler - IMPLEMENTED but NOT CALLED
   Status: ⚠️ EXISTS but NOT ACTIVE (consumer disabled)
   Location: Infrastructure/EventHandlers/NotificationEventHandler.cs
   Would handle:
   - BookingCreatedEvent → Send confirmation email/SMS
   - BookingConfirmedEvent → Send confirmation email/SMS
   - BookingCancelledEvent → Send cancellation email/SMS
   - UserCreatedEvent → Send welcome email/SMS
   - PaymentCompletedEvent → Send receipt email (never raised)
   - PaymentRefundedEvent → Send refund email (never raised)
   
   Note: EmailService and SMSService exist and are functional, but not called automatically

EVENT STRUCTURE (show as JSON):

BookingCreatedEvent:
{
  "EventId": "guid",
  "EventType": "BookingCreated",
  "OccurredOn": "2025-12-05T10:30:00Z",
  "BookingId": 123,
  "GuestId": 456,
  "CampsiteId": 789,
  "CheckInDate": "2025-06-01T00:00:00Z",
  "CheckOutDate": "2025-06-07T00:00:00Z"
}

BookingConfirmedEvent:
{
  "EventId": "guid",
  "EventType": "BookingConfirmed",
  "OccurredOn": "2025-12-05T10:35:00Z",
  "BookingId": 123,
  "GuestId": 456,
  "CheckInDate": "2025-06-01T00:00:00Z",
  "CheckOutDate": "2025-06-07T00:00:00Z"
}

BookingCancelledEvent:
{
  "EventId": "guid",
  "EventType": "BookingCancelled",
  "OccurredOn": "2025-12-05T11:00:00Z",
  "BookingId": 123,
  "GuestId": 456
}

UserCreatedEvent:
{
  "EventId": "guid",
  "EventType": "UserCreated",
  "OccurredOn": "2025-12-05T10:30:00Z",
  "UserId": 456,
  "Email": "user@example.com"
}

UserDeactivatedEvent:
{
  "EventId": "guid",
  "EventType": "UserDeactivated",
  "OccurredOn": "2025-12-05T11:00:00Z",
  "UserId": 456,
  "Email": "user@example.com"
}

FLOW (show with arrows):

1. BookingsController → KafkaProducer: PublishAsync(event)
   (Async publish, fire-and-forget)

2. KafkaProducer → bookmyhome.events topic: Send event
   (Serialized JSON, event type in message key or body)
   Topic: bookmyhome.events (SINGLE TOPIC)

3. bookmyhome.events topic → [KafkaConsumer - DISABLED]
   (Show with dashed line and red X)
   Note: Consumer exists but is not registered

4. [If Consumer Active] KafkaConsumer → NotificationEventHandler: HandleAsync(event)
   (Show with dashed line - not active)

5. [If Consumer Active] NotificationEventHandler → EmailService: SendEmail()
   (Show with dashed line - not active)

6. [If Consumer Active] NotificationEventHandler → SMSService: SendSMS()
   (Show with dashed line - not active)

KAFKA BROKER (center - show as server):

Kafka Broker (Port 9092)
- Manages topic: bookmyhome.events
- Handles partitioning
- Ensures message ordering within partition
- Stores messages temporarily
- Events accumulate (not consumed)

Zookeeper (Port 2181)
- Manages Kafka cluster
- Would track consumer offsets (if consumer active)
- Handles leader election

CONFIGURATION:

Producer Config (KafkaProducer.cs):
- Bootstrap servers: localhost:9092
- Topic: bookmyhome.events
- Acks: All (wait for all replicas to acknowledge)
- EnableIdempotence: true (prevent duplicate messages)
- Retries: 3
- RetryBackoffMs: 1000
- ClientId: bookmyhome-producer

Consumer Config (KafkaConsumer.cs - not active):
- Bootstrap servers: localhost:9092
- Topic: bookmyhome.events
- Group ID: bookmyhome-consumer-group
- Auto offset reset: earliest
- Enable auto commit: true
- Max poll records: 500
- Session timeout: 30s

VISUAL STYLE:
- Use blue boxes for producers
- Use orange cylinder for topic (single topic)
- Use green boxes with RED X for disabled consumers
- Use solid arrows for active message flow (producer → topic)
- Use dashed arrows for disabled/inactive flow (topic → consumer)
- Show event types inside topic
- Add status indicators (✅ ACTIVE, ❌ DISABLED, ⚠️ NOT CALLED)
- Group related components
- Mark disabled components clearly

LEGEND:
- Blue = Producer (API Controllers)
- Orange = Kafka Topic
- Green with Red X = Disabled Consumer
- Solid arrow = Active event flow
- Dashed arrow = Disabled/inactive flow
- ✅ = Active
- ❌ = Disabled
- ⚠️ = Implemented but not called

STATUS SUMMARY:
- ✅ Kafka Producer: ACTIVE (events published)
- ✅ Kafka Broker: ACTIVE
- ✅ bookmyhome.events topic: ACTIVE
- ❌ Kafka Consumer: DISABLED (not registered)
- ⚠️ NotificationEventHandler: EXISTS but NOT CALLED
- ⚠️ EmailService: EXISTS and FUNCTIONAL but not called automatically
- ⚠️ SMSService: EXISTS and FUNCTIONAL but not called automatically

IMPORTANT NOTES:
- Single topic: bookmyhome.events (not multiple topics)
- Consumer is disabled (see Program.cs:227 - commented out)
- Events are published but NOT consumed
- Email/SMS services exist but are not called automatically
- Payment events exist but are never raised (Payment is Entity, not AggregateRoot)
- BookingCompletedEvent does NOT exist (Complete() doesn't raise event)
