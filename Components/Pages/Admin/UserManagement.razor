@page "/admin/users"
@rendermode InteractiveServer
@attribute [Authorize(Roles = "Admin,Staff")]
@using CampsiteBooking.Data
@using CampsiteBooking.Models
@using CampsiteBooking.Models.ValueObjects
@using Microsoft.EntityFrameworkCore
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using System.Security.Claims
@inject IDialogService DialogService
@inject IDbContextFactory<CampsiteBookingDbContext> DbContextFactory
@inject ISnackbar Snackbar
@inject AuthenticationStateProvider AuthenticationStateProvider

<PageTitle>User Management - Campsite Booking</PageTitle>

<MudContainer MaxWidth="MaxWidth.ExtraExtraLarge" Class="mt-4">
    <div class="d-flex justify-space-between align-center mb-6">
        <div>
            <MudText Typo="Typo.h3" GutterBottom="true">
                <MudIcon Icon="@Icons.Material.Filled.People" Class="mr-2" />
                User Management
            </MudText>
            <MudText Typo="Typo.body1" Color="Color.Secondary">
                @if (_isAdmin)
                {
                    <span>Manage users and their roles (@_users.Count total)</span>
                }
                else
                {
                    <span>View users and their roles (@_users.Count total) - Read-only access</span>
                }
            </MudText>
        </div>
        <MudStack Row="true" Spacing="2">
            <MudButton Variant="Variant.Outlined"
                       Color="Color.Primary"
                       StartIcon="@Icons.Material.Filled.Refresh"
                       OnClick="RefreshUsers"
                       Disabled="@_loading">
                @if (_loading)
                {
                    <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="mr-2" />
                    <span>Loading...</span>
                }
                else
                {
                    <span>Refresh</span>
                }
            </MudButton>
            @if (_isAdmin)
            {
                <MudButton Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.PersonAdd" OnClick="OpenAddUserDialog">
                    Add User
                </MudButton>
            }
        </MudStack>
    </div>

    <!-- User Statistics -->
    <MudGrid Class="mb-4">
        <MudItem xs="12" sm="6" md="3">
            <MudCard Elevation="2">
                <MudCardContent>
                    <div class="d-flex justify-space-between align-center">
                        <div>
                            <MudText Typo="Typo.body2" Color="Color.Secondary">Total Users</MudText>
                            <MudText Typo="Typo.h5">@_users.Count</MudText>
                        </div>
                        <MudIcon Icon="@Icons.Material.Filled.People" Color="Color.Primary" Size="Size.Large" />
                    </div>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="12" sm="6" md="3">
            <MudCard Elevation="2">
                <MudCardContent>
                    <div class="d-flex justify-space-between align-center">
                        <div>
                            <MudText Typo="Typo.body2" Color="Color.Secondary">Guests</MudText>
                            <MudText Typo="Typo.h5">@_users.Count(u => u.Role == "Guest")</MudText>
                        </div>
                        <MudIcon Icon="@Icons.Material.Filled.Person" Color="Color.Info" Size="Size.Large" />
                    </div>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="12" sm="6" md="3">
            <MudCard Elevation="2">
                <MudCardContent>
                    <div class="d-flex justify-space-between align-center">
                        <div>
                            <MudText Typo="Typo.body2" Color="Color.Secondary">Staff</MudText>
                            <MudText Typo="Typo.h5">@_users.Count(u => u.Role == "Staff")</MudText>
                        </div>
                        <MudIcon Icon="@Icons.Material.Filled.Badge" Color="Color.Success" Size="Size.Large" />
                    </div>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="12" sm="6" md="3">
            <MudCard Elevation="2">
                <MudCardContent>
                    <div class="d-flex justify-space-between align-center">
                        <div>
                            <MudText Typo="Typo.body2" Color="Color.Secondary">Administrators</MudText>
                            <MudText Typo="Typo.h5">@_users.Count(u => u.Role == "Administrator")</MudText>
                        </div>
                        <MudIcon Icon="@Icons.Material.Filled.AdminPanelSettings" Color="Color.Warning" Size="Size.Large" />
                    </div>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>

    <!-- Filters -->
    <MudPaper Elevation="3" Class="pa-4 mb-4">
        <MudGrid>
            <MudItem xs="12" md="4">
                <MudTextField @bind-Value="_searchText" Label="Search" Variant="Variant.Outlined" 
                              Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" 
                              Immediate="true" />
            </MudItem>
            <MudItem xs="12" md="4">
                <MudSelect T="string" @bind-Value="_filterRole" Label="Role" Variant="Variant.Outlined">
                    <MudSelectItem T="string" Value="@("All")">All Roles</MudSelectItem>
                    <MudSelectItem T="string" Value="@("Guest")">Guest</MudSelectItem>
                    <MudSelectItem T="string" Value="@("Staff")">Staff</MudSelectItem>
                    <MudSelectItem T="string" Value="@("Administrator")">Administrator</MudSelectItem>
                </MudSelect>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudSelect T="string" @bind-Value="_filterStatus" Label="Status" Variant="Variant.Outlined">
                    <MudSelectItem T="string" Value="@("All")">All Status</MudSelectItem>
                    <MudSelectItem T="string" Value="@("Active")">Active</MudSelectItem>
                    <MudSelectItem T="string" Value="@("Inactive")">Inactive</MudSelectItem>
                </MudSelect>
            </MudItem>
        </MudGrid>
    </MudPaper>

    <!-- Users Table -->
    <MudPaper Elevation="3">
        <MudTable Items="@GetFilteredUsers()" Hover="true" Breakpoint="Breakpoint.Sm" Loading="@_loading" Dense="true">
            <HeaderContent>
                <MudTh>User</MudTh>
                <MudTh>Email</MudTh>
                <MudTh>Phone</MudTh>
                <MudTh>Role</MudTh>
                <MudTh>Joined</MudTh>
                <MudTh>Last Login</MudTh>
                <MudTh>Bookings</MudTh>
                <MudTh>Status</MudTh>
                <MudTh>Actions</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="User">
                    <div class="d-flex align-center">
                        <MudAvatar Color="Color.Primary" Size="Size.Small" Class="mr-2">
                            @context.Name.Substring(0, 1).ToUpper()
                        </MudAvatar>
                        <div>
                            <MudText Typo="Typo.body2"><strong>@context.Name</strong></MudText>
                            <MudText Typo="Typo.caption" Color="Color.Secondary">ID: @context.Id</MudText>
                        </div>
                    </div>
                </MudTd>
                <MudTd DataLabel="Email">@context.Email</MudTd>
                <MudTd DataLabel="Phone">@context.Phone</MudTd>
                <MudTd DataLabel="Role">
                    <MudChip T="string" Size="Size.Small" Color="@GetRoleColor(context.Role)" Icon="@GetRoleIcon(context.Role)">
                        @context.Role
                    </MudChip>
                </MudTd>
                <MudTd DataLabel="Joined">@context.JoinedDate.ToString("MMM dd, yyyy")</MudTd>
                <MudTd DataLabel="Last Login">
                    @if (context.LastLogin.HasValue)
                    {
                        <MudText Typo="Typo.caption">@context.LastLogin.Value.ToString("MMM dd, yyyy")</MudText>
                    }
                    else
                    {
                        <MudText Typo="Typo.caption" Color="Color.Secondary">Never</MudText>
                    }
                </MudTd>
                <MudTd DataLabel="Bookings">@context.TotalBookings</MudTd>
                <MudTd DataLabel="Status">
                    <MudChip T="string" Size="Size.Small" Color="@(context.IsActive ? Color.Success : Color.Default)">
                        @(context.IsActive ? "Active" : "Inactive")
                    </MudChip>
                </MudTd>
                <MudTd DataLabel="Actions">
                    @if (_isAdmin)
                    {
                        <MudMenu Icon="@Icons.Material.Filled.MoreVert" Size="Size.Small">
                            <MudMenuItem Icon="@Icons.Material.Filled.Edit" OnAction="@(() => EditUser(context))">Edit</MudMenuItem>
                            <MudMenuItem Icon="@Icons.Material.Filled.Security" OnAction="@(() => ChangeRole(context))">Change Role</MudMenuItem>
                            @if (context.IsActive)
                            {
                                <MudMenuItem Icon="@Icons.Material.Filled.Block" OnAction="@(() => DeactivateUser(context))">Deactivate</MudMenuItem>
                            }
                            else
                            {
                                <MudMenuItem Icon="@Icons.Material.Filled.CheckCircle" OnAction="@(() => ActivateUser(context))">Activate</MudMenuItem>
                            }
                            <MudMenuItem Icon="@Icons.Material.Filled.Delete" OnAction="@(() => DeleteUser(context))">Delete</MudMenuItem>
                        </MudMenu>
                    }
                    else
                    {
                        <MudText Typo="Typo.caption" Color="Color.Secondary">View only</MudText>
                    }
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100 }" />
            </PagerContent>
        </MudTable>
    </MudPaper>
</MudContainer>

@code {
    private bool _loading = false;
    private bool _isAdmin = false;
    private string _searchText = "";
    private string _filterRole = "All";
    private string _filterStatus = "All";
    private List<UserManagementDto> _users = new();
    private List<AddUserDialog.CampsiteDto> _campsites = new();

    protected override async Task OnInitializedAsync()
    {
        // Check if user is Admin
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;
        _isAdmin = user.IsInRole("Admin");

        await LoadUsersAsync();
        await LoadCampsitesAsync();
    }

    private async Task RefreshUsers()
    {
        Console.WriteLine("üîÑ Admin manually refreshing users...");
        await LoadUsersAsync();
        Snackbar.Add($"Refreshed! Found {_users.Count} users", Severity.Success);
        StateHasChanged();
    }

    private async Task LoadUsersAsync()
    {
        _loading = true;
        StateHasChanged();

        try
        {
            Console.WriteLine("\n" + new string('=', 80));
            Console.WriteLine("üë• ADMIN USER MANAGEMENT - Loading users from database...");
            Console.WriteLine(new string('=', 80));

            using var context = await DbContextFactory.CreateDbContextAsync();

            // Load all users from database
            var users = await context.Users.ToListAsync();
            Console.WriteLine($"   ‚úÖ Loaded {users.Count} users from Users table");

            // Get booking counts for each user - load into memory first to avoid LINQ translation issues
            var allBookings = await context.Bookings.ToListAsync();
            var bookingCounts = allBookings
                .GroupBy(b => b.GuestId.Value)
                .ToDictionary(g => g.Key, g => g.Count());
            Console.WriteLine($"   ‚úÖ Loaded {allBookings.Count} bookings for user statistics");

            _users = users.Select(u => new UserManagementDto
            {
                Id = u.UserId,
                Name = $"{u.FirstName} {u.LastName}",
                FirstName = u.FirstName,
                LastName = u.LastName,
                Email = u.Email.Value,
                Phone = u.Phone,
                Country = u.Country,
                Role = GetUserRole(u),
                JoinedDate = u.JoinedDate,
                LastLogin = u.LastLogin,
                TotalBookings = bookingCounts.GetValueOrDefault(u.UserId, 0),
                IsActive = u.IsActive,
                CampsiteId = u is Staff staff ? staff.CampsiteId?.Value : null
            }).ToList();

            Console.WriteLine($"   ‚úÖ Converted {_users.Count} users to DTOs");

            if (_users.Any())
            {
                var roleGroups = _users.GroupBy(u => u.Role).ToList();
                Console.WriteLine($"\n   üìã Users by role:");
                foreach (var group in roleGroups)
                {
                    Console.WriteLine($"      - {group.Key}: {group.Count()}");
                }

                Console.WriteLine($"\n   üìã Recent users (last 3):");
                foreach (var user in _users.OrderByDescending(u => u.Id).Take(3))
                {
                    Console.WriteLine($"      - ID: {user.Id}, Name: {user.Name}, " +
                                    $"Email: {user.Email}, Role: {user.Role}");
                }
            }
            else
            {
                Console.WriteLine($"\n   ‚ö†Ô∏è  NO USERS FOUND! This could mean:");
                Console.WriteLine($"      1. No users have been created yet");
                Console.WriteLine($"      2. Users are not being saved to the database");
                Console.WriteLine($"      3. Database connection issue");
            }

            Console.WriteLine(new string('=', 80) + "\n");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"‚ùå Error loading users: {ex.Message}");
            Console.WriteLine($"   Stack trace: {ex.StackTrace}");
            _users = new List<UserManagementDto>();
        }
        finally
        {
            _loading = false;
            StateHasChanged();
        }
    }

    private async Task LoadCampsitesAsync()
    {
        using var context = await DbContextFactory.CreateDbContextAsync();
        var campsites = await context.Campsites.ToListAsync();
        _campsites = campsites.Select(c => new AddUserDialog.CampsiteDto
        {
            Id = c.CampsiteId,
            Name = c.Name
        }).ToList();
    }

    private string GetUserRole(User user)
    {
        return user switch
        {
            Admin => "Administrator",
            Staff => "Staff",
            Guest => "Guest",
            _ => "Guest"
        };
    }

    private IEnumerable<UserManagementDto> GetFilteredUsers()
    {
        var filtered = _users.AsEnumerable();

        if (!string.IsNullOrWhiteSpace(_searchText))
        {
            filtered = filtered.Where(u =>
                u.Name.Contains(_searchText, StringComparison.OrdinalIgnoreCase) ||
                u.Email.Contains(_searchText, StringComparison.OrdinalIgnoreCase) ||
                u.Phone.Contains(_searchText, StringComparison.OrdinalIgnoreCase));
        }

        if (_filterRole != "All")
        {
            filtered = filtered.Where(u => u.Role == _filterRole);
        }

        if (_filterStatus != "All")
        {
            var isActive = _filterStatus == "Active";
            filtered = filtered.Where(u => u.IsActive == isActive);
        }

        return filtered;
    }

    private Color GetRoleColor(string role) => role switch
    {
        "Administrator" => Color.Warning,
        "Staff" => Color.Success,
        "Guest" => Color.Info,
        _ => Color.Default
    };

    private string GetRoleIcon(string role) => role switch
    {
        "Administrator" => Icons.Material.Filled.AdminPanelSettings,
        "Staff" => Icons.Material.Filled.Badge,
        "Guest" => Icons.Material.Filled.Person,
        _ => Icons.Material.Filled.Person
    };

    private async Task OpenAddUserDialog()
    {
        var parameters = new DialogParameters
        {
            { "Campsites", _campsites }
        };

        var options = new DialogOptions { MaxWidth = MaxWidth.Medium, FullWidth = true };
        var dialog = await DialogService.ShowAsync<AddUserDialog>("Add New User", parameters, options);
        var result = await dialog.Result;

        if (!result.Canceled && result.Data is UserManagementDto newUser)
        {
            await AddUserAsync(newUser);
        }
    }

    private async Task AddUserAsync(UserManagementDto userDto)
    {
        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var email = Email.Create(userDto.Email);

            // Check if email already exists
            var emailExists = await context.Users.AnyAsync(u => u.Email == email);
            if (emailExists)
            {
                await DialogService.ShowMessageBox("Error", "A user with this email already exists.", "OK");
                return;
            }

            User user;

            // Create user based on role
            if (userDto.Role == "Administrator")
            {
                user = Admin.Create(email, userDto.FirstName, userDto.LastName, userDto.Phone, userDto.Country);
            }
            else if (userDto.Role == "Staff")
            {
                // For staff, we need a campsite ID and employee ID
                if (!userDto.CampsiteId.HasValue)
                {
                    await DialogService.ShowMessageBox("Error", "Staff members must be assigned to a campsite.", "OK");
                    return;
                }

                var campsiteId = CampsiteId.Create(userDto.CampsiteId.Value);
                var employeeId = $"EMP{DateTime.UtcNow:yyyyMMddHHmmss}"; // Generate employee ID
                var hireDate = DateTime.UtcNow;

                user = Staff.Create(email, userDto.FirstName, userDto.LastName, employeeId, campsiteId, hireDate, "", userDto.Phone, userDto.Country);
            }
            else
            {
                user = Guest.Create(email, userDto.FirstName, userDto.LastName, userDto.Phone, userDto.Country);
            }

            await context.Users.AddAsync(user);
            await context.SaveChangesAsync();

            await LoadUsersAsync();
            await DialogService.ShowMessageBox("Success", $"User '{userDto.Name}' has been added successfully.", "OK");
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to add user: {ex.Message}", "OK");
        }
    }

    private async Task EditUser(UserManagementDto user)
    {
        var parameters = new DialogParameters
        {
            { "User", user },
            { "Campsites", _campsites }
        };

        var options = new DialogOptions { MaxWidth = MaxWidth.Medium, FullWidth = true };
        var dialog = await DialogService.ShowAsync<AddUserDialog>("Edit User", parameters, options);
        var result = await dialog.Result;

        if (!result.Canceled && result.Data is UserManagementDto updatedUser)
        {
            await UpdateUserAsync(updatedUser);
        }
    }

    private async Task UpdateUserAsync(UserManagementDto userDto)
    {
        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var userId = UserId.Create(userDto.Id);
            var user = await context.Users.FirstOrDefaultAsync(u => u.Id == userId);

            if (user == null)
            {
                await DialogService.ShowMessageBox("Error", "User not found.", "OK");
                return;
            }

            // Update contact info
            user.UpdateContactInfo(userDto.Phone, userDto.Country);

            await context.SaveChangesAsync();
            await LoadUsersAsync();
            await DialogService.ShowMessageBox("Success", $"User '{userDto.Name}' has been updated successfully.", "OK");
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to update user: {ex.Message}", "OK");
        }
    }

    private async Task ChangeRole(UserManagementDto user)
    {
        var parameters = new DialogParameters
        {
            { "User", user },
            { "Campsites", _campsites }
        };

        var options = new DialogOptions { MaxWidth = MaxWidth.Medium, FullWidth = true };
        var dialog = await DialogService.ShowAsync<ChangeRoleDialog>("Change User Role", parameters, options);
        var result = await dialog.Result;

        if (!result.Canceled && result.Data is ChangeRoleDialog.RoleChangeResult roleChange)
        {
            await ChangeUserRoleAsync(user, roleChange.NewRole, roleChange.CampsiteId);
        }
    }

    private async Task ChangeUserRoleAsync(UserManagementDto userDto, string newRole, int? campsiteId)
    {
        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var userId = UserId.Create(userDto.Id);
            var oldUser = await context.Users.FirstOrDefaultAsync(u => u.Id == userId);

            if (oldUser == null)
            {
                await DialogService.ShowMessageBox("Error", "User not found.", "OK");
                return;
            }

            // Remove old user
            context.Users.Remove(oldUser);

            // Create new user with same data but different role
            var email = oldUser.Email;
            User newUser;

            if (newRole == "Administrator")
            {
                newUser = Admin.Create(email, oldUser.FirstName, oldUser.LastName, oldUser.Phone, oldUser.Country);
            }
            else if (newRole == "Staff")
            {
                if (!campsiteId.HasValue)
                {
                    await DialogService.ShowMessageBox("Error", "Staff members must be assigned to a campsite.", "OK");
                    return;
                }

                var staffCampsiteId = CampsiteId.Create(campsiteId.Value);
                var employeeId = $"EMP{DateTime.UtcNow:yyyyMMddHHmmss}";
                var hireDate = DateTime.UtcNow;

                newUser = Staff.Create(email, oldUser.FirstName, oldUser.LastName, employeeId, staffCampsiteId, hireDate, "", oldUser.Phone, oldUser.Country);
            }
            else
            {
                newUser = Guest.Create(email, oldUser.FirstName, oldUser.LastName, oldUser.Phone, oldUser.Country);
            }

            // Preserve the same ID
            typeof(User).GetProperty("UserId")!.SetValue(newUser, oldUser.UserId);

            await context.Users.AddAsync(newUser);
            await context.SaveChangesAsync();

            await LoadUsersAsync();
            await DialogService.ShowMessageBox("Success", $"User role changed to '{newRole}' successfully.", "OK");
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to change user role: {ex.Message}", "OK");
        }
    }

    private async Task ActivateUser(UserManagementDto userDto)
    {
        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var userId = UserId.Create(userDto.Id);
            var user = await context.Users.FirstOrDefaultAsync(u => u.Id == userId);

            if (user == null)
            {
                await DialogService.ShowMessageBox("Error", "User not found.", "OK");
                return;
            }

            user.Activate();
            await context.SaveChangesAsync();

            userDto.IsActive = true;
            StateHasChanged();
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to activate user: {ex.Message}", "OK");
        }
    }

    private async Task DeactivateUser(UserManagementDto userDto)
    {
        bool? confirm = await DialogService.ShowMessageBox(
            "Deactivate User",
            $"Are you sure you want to deactivate user '{userDto.Name}'?",
            yesText: "Deactivate", cancelText: "Cancel");

        if (confirm != true) return;

        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var userId = UserId.Create(userDto.Id);
            var user = await context.Users.FirstOrDefaultAsync(u => u.Id == userId);

            if (user == null)
            {
                await DialogService.ShowMessageBox("Error", "User not found.", "OK");
                return;
            }

            user.Deactivate();
            await context.SaveChangesAsync();

            userDto.IsActive = false;
            StateHasChanged();
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to deactivate user: {ex.Message}", "OK");
        }
    }

    private async Task DeleteUser(UserManagementDto userDto)
    {
        bool? result = await DialogService.ShowMessageBox(
            "Delete User",
            $"Are you sure you want to delete user '{userDto.Name}'? This action cannot be undone.",
            yesText: "Delete", cancelText: "Cancel");

        if (result != true) return;

        try
        {
            using var context = await DbContextFactory.CreateDbContextAsync();

            var userId = UserId.Create(userDto.Id);
            var user = await context.Users.FirstOrDefaultAsync(u => u.Id == userId);

            if (user == null)
            {
                await DialogService.ShowMessageBox("Error", "User not found.", "OK");
                return;
            }

            // Check if user has bookings
            var hasBookings = await context.Bookings.AnyAsync(b => b.GuestId.Value == userDto.Id);
            if (hasBookings)
            {
                await DialogService.ShowMessageBox(
                    "Cannot Delete User",
                    "This user has existing bookings and cannot be deleted. Consider deactivating the user instead.",
                    "OK");
                return;
            }

            context.Users.Remove(user);
            await context.SaveChangesAsync();

            _users.Remove(userDto);
            StateHasChanged();

            await DialogService.ShowMessageBox("Success", $"User '{userDto.Name}' has been deleted successfully.", "OK");
        }
        catch (Exception ex)
        {
            await DialogService.ShowMessageBox("Error", $"Failed to delete user: {ex.Message}", "OK");
        }
    }

    public class UserManagementDto
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string FirstName { get; set; } = string.Empty;
        public string LastName { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public string Phone { get; set; } = string.Empty;
        public string Country { get; set; } = string.Empty;
        public string Role { get; set; } = string.Empty;
        public DateTime JoinedDate { get; set; }
        public DateTime? LastLogin { get; set; }
        public int TotalBookings { get; set; }
        public bool IsActive { get; set; }
        public int? CampsiteId { get; set; }
    }
}

